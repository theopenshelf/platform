<div>
    <h1>My Borrowed Items</h1>

    <!-- Filter Section -->
    <div class="filters">
        <label>
            Category:
            <select [(ngModel)]="categoryFilter">
                <option value="">All</option>
                <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
            </select>
        </label>
        <label>
            Status:
            <select [(ngModel)]="statusFilter">
                <option value="">All</option>
                <option *ngFor="let status of statuses" [value]="status">{{ status }}</option>
            </select>
        </label>
    </div>

    <!-- Borrowed Items Table -->
    <table tuiTable [size]="size">
        <thead>
            <tr>
                <th tuiTh (click)="sort('name')">Item Name {{ getSortIndicator('name') }}</th>
                <th tuiTh (click)="sort('description')">Description {{ getSortIndicator('description') }}</th>
                <th tuiTh (click)="sort('category')">Category {{ getSortIndicator('category') }}</th>
                <th tuiTh (click)="sort('borrowedOn')">Borrowed On {{ getSortIndicator('borrowedOn') }}</th>
                <th tuiTh (click)="sort('dueDate')">Due Date {{ getSortIndicator('dueDate') }}</th>
                <th tuiTh (click)="sort('status')">Status {{ getSortIndicator('status') }}</th>
            </tr>
        </thead>
        <tbody tuiTbody>
            <tr *ngFor="let item of filteredAndSortedData">
                <td tuiTd>{{ item.name }}</td>
                <td tuiTd>{{ item.description }}</td>
                <td tuiTd>
                    <span [ngClass]="getCategoryBadgeClass(item.category)">
                        {{ item.category }}
                    </span>
                </td>
                <td tuiTd>{{ formatDate(item.borrowedOn, computeStatus(item.borrowedOn, item.dueDate)) }}</td>
                <td tuiTd>{{ formatDate(item.dueDate, computeStatus(item.borrowedOn, item.dueDate)) }}</td>
                <td tuiTd>
                    <span [ngClass]="getBadgeClass(computeStatus(item.borrowedOn, item.dueDate))">
                        {{ computeStatus(item.borrowedOn, item.dueDate) }}
                    </span>
                </td>
            </tr>
        </tbody>
    </table>
</div>